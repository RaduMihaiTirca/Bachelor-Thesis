clear all;N=10;S(N+2,N+2)=0;for j=2:N+1  for k=2:N+1      temp=rand;    if temp<0.5      S(j,k)=1;    else      S(j,k)=-1;    endif      endfor endforT=8;DT=1;Tmin=0.1;n=5000;J=1;contor=1;ticwhile T>Tmin  P(1:4*J*N^2,contor)=(1:4*J*N^2)*0;  M(contor)=0;  E(contor)=0;    for j=1:n    x=round(2+rand*(N-1));    y=round(2+rand*(N-1));    DE=4*J*S(x,y)*(S(x-1,y)+S(x,y-1)+S(x+1,y)+S(x,y+1));    r=exp(-DE/T);    if r>rand      S(x,y)=-S(x,y);          endif              Energy=0;      for c1=2:N+1        for c2=2:N+1          Energy=Energy-J*S(c1,c2)*(S(c1-1,c2)+S(c1+1,c2)+S(c1,c2-1)+S(c1,c2+1));        endfor      endfor            if Energy<0      P(-Energy,contor)=P(-Energy,contor)+1;      endif              M(contor)=M(contor)+sum(sum(S));  endfor    M(contor)=M(contor)/n;  E(contor)=E(contor)/n;  Temp(contor)=T;  contor=contor+1;    T=T-DT;endwhiletocfor j=1:(contor-1)  figure(j);  plot(-(1:4*J*N^2),P(:,j))endforS